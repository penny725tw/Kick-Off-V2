<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitation Generator - Emers Kick Off 2026</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* --- UI STYLING (Control Panel) --- */
        body { 
            font-family: "Segoe UI", sans-serif; 
            background: #f4f6f9; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 20px; 
            color: #333;
        }
        .controls { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            width: 100%; 
            max-width: 900px; 
            margin-bottom: 30px; 
            border-top: 5px solid #d9534f; /* Emers Red-ish color theme */
        }
        .controls h2 { margin-top: 0; color: #d9534f; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
        
        .grid-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }
        
        .form-group { margin-bottom: 10px; }
        label { font-size: 13px; font-weight: bold; color: #555; display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        input:focus { border-color: #d9534f; outline: none; }

        button { 
            background-color: #d9534f; 
            color: white; 
            padding: 15px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 18px; 
            font-weight: bold; 
            width: 100%; 
            margin-top: 20px; 
            transition: 0.3s; 
        }
        button:hover { background-color: #c9302c; }

        /* --- LETTER STYLING (A4 Paper) --- */
        #letter-preview {
            background: white;
            width: 210mm; 
            min-height: 297mm;
            padding: 25mm 25mm; 
            box-shadow: 0 0 20px rgba(0,0,0,0.15);
            font-family: "Times New Roman", serif; 
            color: #000;
            font-size: 12pt;
            line-height: 1.5;
            position: relative;
        }
        
        /* Letter Layout */
        .header-logo { margin-bottom: 30px; } /* Placeholder for logo */
        .recipient-block { margin-bottom: 30px; }
        .subject-line { font-weight: bold; margin-bottom: 20px; }
        .body-text { margin-bottom: 20px; text-align: justify; }
        .visitor-details { margin-left: 20px; margin-bottom: 20px; }
        .sign-off { margin-top: 50px; }
        .signature-img { height: 60px; margin-top: 10px; margin-bottom: 10px; } /* Placeholder */

        /* Highlights for editing */
        .var { color: #d9534f; font-weight: 500; }
    </style>
</head>
<body>

    <div class="controls">
        <h2>‚úâÔ∏è Invitation Generator (2026 Kick Off)</h2>
        
        <div class="grid-container">
            <div class="full-width" style="font-weight:bold; color:#555; margin-top:10px;">Guest Information</div>
            
            <div class="form-group">
                <label>Gender (Title):</label>
                <select id="inGender" onchange="update()">
                    <option value="Mr.">Mr.</option>
                    <option value="Ms.">Ms.</option>
                    <option value="Mrs.">Mrs.</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Full Name:</label>
                <input type="text" id="inName" placeholder="e.g. John Doe" oninput="update()">
            </div>

            <div class="form-group">
                <label>Position:</label>
                <input type="text" id="inPosition" placeholder="e.g. Director" oninput="update()">
            </div>

            <div class="form-group">
                <label>Company Name:</label>
                <input type="text" id="inCompany" placeholder="e.g. ABC Global Inc." oninput="update()">
            </div>

            <div class="form-group full-width">
                <label>Company Address:</label>
                <input type="text" id="inAddress" placeholder="e.g. 123 Business Rd, Singapore" oninput="update()">
            </div>

            <div class="full-width" style="font-weight:bold; color:#555; margin-top:10px; border-top:1px dashed #ccc; padding-top:10px;">Passport Details (For Visitor)</div>
            
            <div class="form-group">
                <label>Passport Number:</label>
                <input type="text" id="inPassport" oninput="update()">
            </div>
            
            <div class="form-group">
                <label>Issue Date:</label>
                <input type="date" id="inIssueDate" onchange="update()">
            </div>
            
            <div class="form-group full-width">
                <label>Issue Place:</label>
                <input type="text" id="inIssuePlace" placeholder="e.g. Ho Chi Minh City / USA" oninput="update()">
            </div>
        </div>

        <button onclick="generatePDF()">üì• Download Invitation PDF</button>
    </div>

    <div id="letter-preview">
        <div class="recipient-block">
            <div><span id="outGender" class="var">Mr.</span> <span id="outName" class="var">[Full Name]</span></div>
            <div>Position: <span id="outPosition" class="var">[Position]</span></div>
            <div>Company name: <span id="outCompany" class="var">[Company Name]</span></div>
            <div>Company Address: <span id="outAddress" class="var">[Company Address]</span></div>
        </div>

        <div class="subject-line">
            Subject: Invitation for the business meeting regarding to 2026 Kick Off Meeting at Emers Vietnam Co., Ltd.
        </div>

        <div class="body-text">
            To whom it may concern,
        </div>

        <div class="body-text">
            On behalf of Emers Vietnam Co., Ltd. we would like to invite the personnel with details below to visit our office in Ho Chi Minh City.
        </div>

        <div class="body-text">
            Purpose of the visit in reference to 2026 Kick Off Meeting
        </div>

        <div class="visitor-details">
            <div>Full name: <span id="outGender2" class="var">Mr.</span> <span id="outName2" class="var">[Full Name]</span></div>
            <div>Passport number: <span id="outPassport" class="var">...</span></div>
            <div>Passport issue date: <span id="outIssueDate" class="var">...</span></div>
            <div>Passport issue place: <span id="outIssuePlace" class="var">...</span></div>
        </div>

        <div class="body-text">
            The event / meeting will be conducted from 24/12, 2025.
        </div>

        <div class="body-text">
            We appreciate for your interest & support to attend the event at Emers Vietnam.
        </div>

        <div class="sign-off">
            <div>Best regards,</div>
            <br>
            <div>On behalf of Emers Vietnam Co., Ltd.</div>
            
            <div style="height: 50px;"></div> 
            
            <div style="font-weight: bold;">Yu Yuan Kai</div>
            <div>Vice President</div>
        </div>
    </div>

    <script>
        // 1. Update Function
        function update() {
            // Get Values
            const gender = document.getElementById('inGender').value;
            const name = document.getElementById('inName').value;
            const position = document.getElementById('inPosition').value;
            const company = document.getElementById('inCompany').value;
            const address = document.getElementById('inAddress').value;
            
            const passport = document.getElementById('inPassport').value;
            const issuePlace = document.getElementById('inIssuePlace').value;
            
            // Date formatting for Issue Date
            const dateVal = document.getElementById('inIssueDate').value;
            let dateFormatted = "";
            if (dateVal) {
                const d = new Date(dateVal);
                // Format: DD/MM/YYYY
                dateFormatted = d.getDate().toString().padStart(2,'0') + '/' + (d.getMonth()+1).toString().padStart(2,'0') + '/' + d.getFullYear();
            }

            // Map to HTML
            // Note: We map Name/Gender to TWO places (Top address block AND Visitor details)
            // This is the "Efficiency" feature.
            document.getElementById('outGender').innerText = gender;
            document.getElementById('outGender2').innerText = gender;
            
            document.getElementById('outName').innerText = name || "[Full Name]";
            document.getElementById('outName2').innerText = name || "[Full Name]";
            
            document.getElementById('outPosition').innerText = position || "...";
            document.getElementById('outCompany').innerText = company || "...";
            document.getElementById('outAddress').innerText = address || "...";
            
            document.getElementById('outPassport').innerText = passport || "...";
            document.getElementById('outIssueDate').innerText = dateFormatted || "...";
            document.getElementById('outIssuePlace').innerText = issuePlace || "...";
        }

        // 2. PDF Generator
        function generatePDF() {
            // Turn text black for printing
            const vars = document.querySelectorAll('.var');
            vars.forEach(v => v.style.color = 'black');

            const element = document.getElementById('letter-preview');
            // Use the guest's name for the filename
            const filename = 'Invitation_Emers_KickOff_' + (document.getElementById('inName').value || 'Guest') + '.pdf';

            const opt = {
                margin:       15, // Standard print margin
                filename:     filename,
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2 },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                // Restore preview color
                vars.forEach(v => v.style.color = '#d9534f');
            });
        }
        
        // Init
        update();
    </script>
</body>
</html>